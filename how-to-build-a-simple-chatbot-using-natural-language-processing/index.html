<!doctype html><html lang=en dir=auto><head><title>How to Build a Simple Chatbot Using Natural Language Processing</title>
<link rel=canonical href=https://science.googlexy.com/how-to-build-a-simple-chatbot-using-natural-language-processing/><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><meta name=description content><meta name=author content><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://science.googlexy.com/logo.svg><link rel=icon type=image/png sizes=16x16 href=https://science.googlexy.com/logo.svg><link rel=icon type=image/png sizes=32x32 href=https://science.googlexy.com/logo.svg><link rel=apple-touch-icon href=https://science.googlexy.com/logo.svg><link rel=mask-icon href=https://science.googlexy.com/logo.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://science.googlexy.com/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="All the science is here!"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://science.googlexy.com/"><meta name=twitter:card content="summary"><meta name=twitter:title content="All the science is here!"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"All the science is here!","url":"https://science.googlexy.com/","description":"","thumbnailUrl":"https://science.googlexy.com/logo.svg","sameAs":[]}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6194699946397512" crossorigin=anonymous></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://science.googlexy.com/ accesskey=h title="Home (Alt + H)"><img src=https://science.googlexy.com/logo.svg alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://science.googlexy.com/articles/ title=Articles><span>Articles</span></a></li><li><a href=https://science.googlexy.com/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How to Build a Simple Chatbot Using Natural Language Processing</h1><div class=post-description></div></header><figure class=entry-cover><img loading=eager src=https://science.googlexy.com/images/machine-learning.jpeg alt></figure><br><div class=post-content><p>In today&rsquo;s digital age, chatbots have become an essential tool for businesses, enhancing customer interactions and providing immediate support. These AI-driven conversational agents simplify complex processes, save time, and improve user experiences. The best part? Building a simple chatbot is not as intimidating as it may initially sound, thanks to advancements in Natural Language Processing (NLP). In this guide, we&rsquo;ll walk through the step-by-step process of creating a basic chatbot that leverages NLP to respond to user queries effectively.</p><hr><h2 id=understanding-the-basics-of-a-chatbot>Understanding the Basics of a Chatbot</h2><p>Before diving into the nitty-gritty of development, it’s important to understand what a chatbot is and how NLP plays a central role. A chatbot is a software application designed to simulate human-like conversations with users, either through text or voice.</p><p>Natural Language Processing, a subset of artificial intelligence, enables chatbots to understand, interpret, and respond to human language. Unlike rule-based systems that follow strict predefined patterns, NLP-powered chatbots can grasp the context of conversations, making interactions more fluid and dynamic.</p><hr><h2 id=tools-and-technologies-youll-need>Tools and Technologies You&rsquo;ll Need</h2><p>To build a functional chatbot, you’ll need the right tools and frameworks. Here’s what we’ll use in this guide:</p><ol><li><strong>Python</strong>: A versatile programming language that&rsquo;s widely used for AI and machine learning applications.</li><li><strong>NLTK or SpaCy</strong>: These libraries offer extensive capabilities for natural language processing.</li><li><strong>Flask</strong>: A lightweight web framework to build a web interface for the chatbot.</li><li><strong>JSON</strong>: To structure and store conversational data.</li><li><strong>A Text Editor or IDE</strong>: Tools like PyCharm, VSCode, or Jupyter Notebook make coding easier.</li></ol><p>Now that we have identified the tools, let’s break the process into manageable steps.</p><hr><h2 id=step-1-setting-up-your-environment>Step 1: Setting Up Your Environment</h2><p>First, ensure you have Python installed on your system. You can download it from the <a href=https://www.python.org/>official Python website</a>. Once Python is installed, set up a virtual environment to isolate your project dependencies:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install virtualenv
</span></span><span class=line><span class=cl>virtualenv chatbot_env
</span></span><span class=line><span class=cl><span class=nb>source</span> chatbot_env/bin/activate  <span class=c1># or chatbot_env\Scripts\activate on Windows</span>
</span></span></code></pre></div><p>Next, install the required libraries:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install nltk flask
</span></span></code></pre></div><p>In case you decide to use SpaCy instead of NLTK, you can install it with:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install spacy
</span></span><span class=line><span class=cl>python -m spacy download en_core_web_sm
</span></span></code></pre></div><hr><h2 id=step-2-preparing-the-chatbots-dataset>Step 2: Preparing the Chatbot’s Dataset</h2><p>For a rule-based or simple NLP chatbot, you’ll require a basic dataset to handle user queries and responses. Create a <code>data.json</code> file to structure the bot’s conversational data as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;intents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;tag&#34;</span><span class=p>:</span> <span class=s2>&#34;greeting&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;patterns&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Hi&#34;</span><span class=p>,</span> <span class=s2>&#34;Hello&#34;</span><span class=p>,</span> <span class=s2>&#34;Hey&#34;</span><span class=p>,</span> <span class=s2>&#34;How are you?&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;responses&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Hello!&#34;</span><span class=p>,</span> <span class=s2>&#34;Hi there!&#34;</span><span class=p>,</span> <span class=s2>&#34;Hey! How can I help you?&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;tag&#34;</span><span class=p>:</span> <span class=s2>&#34;goodbye&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;patterns&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Bye&#34;</span><span class=p>,</span> <span class=s2>&#34;See you later&#34;</span><span class=p>,</span> <span class=s2>&#34;Goodbye&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;responses&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Goodbye!&#34;</span><span class=p>,</span> <span class=s2>&#34;See you soon!&#34;</span><span class=p>,</span> <span class=s2>&#34;Take care!&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;tag&#34;</span><span class=p>:</span> <span class=s2>&#34;thanks&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;patterns&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;Thank you&#34;</span><span class=p>,</span> <span class=s2>&#34;Thanks&#34;</span><span class=p>,</span> <span class=s2>&#34;I appreciate it&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;responses&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;You’re welcome!&#34;</span><span class=p>,</span> <span class=s2>&#34;Glad I could help!&#34;</span><span class=p>,</span> <span class=s2>&#34;Anytime!&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The dataset is structured into <code>intents</code>, each containing patterns (user inputs) and corresponding responses.</p><hr><h2 id=step-3-tokenizing-and-processing-language-input>Step 3: Tokenizing and Processing Language Input</h2><p>Language input from users must be tokenized and preprocessed to make it understandable for the chatbot. Using NLP libraries like NLTK or SpaCy allows you to clean, tokenize, and normalize text. Here’s an example using NLTK:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>nltk</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>nltk.stem</span> <span class=kn>import</span> <span class=n>WordNetLemmatizer</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>nltk</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=s1>&#39;punkt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>nltk</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=s1>&#39;wordnet&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>lemmatizer</span> <span class=o>=</span> <span class=n>WordNetLemmatizer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Load the chatbot data</span>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;data.json&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize vocabulary</span>
</span></span><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>classes</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>documents</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Loop through each intent</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>intent</span> <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;intents&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pattern</span> <span class=ow>in</span> <span class=n>intent</span><span class=p>[</span><span class=s1>&#39;patterns&#39;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=c1># Tokenize each word</span>
</span></span><span class=line><span class=cl>        <span class=n>tokenized_words</span> <span class=o>=</span> <span class=n>nltk</span><span class=o>.</span><span class=n>word_tokenize</span><span class=p>(</span><span class=n>pattern</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>words</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>tokenized_words</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>documents</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>tokenized_words</span><span class=p>,</span> <span class=n>intent</span><span class=p>[</span><span class=s1>&#39;tag&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Store the tag</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>intent</span><span class=p>[</span><span class=s1>&#39;tag&#39;</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>classes</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>classes</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>intent</span><span class=p>[</span><span class=s1>&#39;tag&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lemmatize and lower-case all words</span>
</span></span><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=p>[</span><span class=n>lemmatizer</span><span class=o>.</span><span class=n>lemmatize</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span> <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>words</span> <span class=k>if</span> <span class=n>w</span><span class=o>.</span><span class=n>isalnum</span><span class=p>()]</span>
</span></span><span class=line><span class=cl><span class=n>words</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>words</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>classes</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>classes</span><span class=p>))</span>
</span></span></code></pre></div><p>This code does the following:</p><ul><li>Tokenizes each user pattern into words for processing.</li><li>Lemmatizes (reduces words to their base or root form) to simplify variations like &ldquo;running&rdquo; versus &ldquo;run.&rdquo;</li><li>Collects all vocabulary and intent classes, which will be useful for building a model.</li></ul><hr><h2 id=step-4-building-a-simple-neural-network>Step 4: Building a Simple Neural Network</h2><p>Although basic chatbots may not need advanced machine learning, a neural network can help classify user inputs and match them to the correct intent. Let’s implement a basic model using TensorFlow or Keras:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow.keras.models</span> <span class=kn>import</span> <span class=n>Sequential</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow.keras.layers</span> <span class=kn>import</span> <span class=n>Dense</span><span class=p>,</span> <span class=n>Dropout</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow.keras.optimizers</span> <span class=kn>import</span> <span class=n>SGD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Prepare training data</span>
</span></span><span class=line><span class=cl><span class=n>training</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>output_empty</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>classes</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>doc</span> <span class=ow>in</span> <span class=n>documents</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>bag</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>pattern_words</span> <span class=o>=</span> <span class=p>[</span><span class=n>lemmatizer</span><span class=o>.</span><span class=n>lemmatize</span><span class=p>(</span><span class=n>w</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span> <span class=k>for</span> <span class=n>w</span> <span class=ow>in</span> <span class=n>doc</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=n>bag</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span> <span class=k>if</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>pattern_words</span> <span class=k>else</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>output_row</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>output_empty</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>output_row</span><span class=p>[</span><span class=n>classes</span><span class=o>.</span><span class=n>index</span><span class=p>(</span><span class=n>doc</span><span class=p>[</span><span class=mi>1</span><span class=p>])]</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>training</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>bag</span><span class=p>,</span> <span class=n>output_row</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>training</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>training</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>object</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>train_X</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>training</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>train_y</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>data</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>training</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Build the neural network</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=n>input_shape</span><span class=o>=</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>train_X</span><span class=p>[</span><span class=mi>0</span><span class=p>]),),</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dropout</span><span class=p>(</span><span class=mf>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>64</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dropout</span><span class=p>(</span><span class=mf>0.5</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>train_y</span><span class=p>[</span><span class=mi>0</span><span class=p>]),</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;softmax&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Compile the model</span>
</span></span><span class=line><span class=cl><span class=n>sgd</span> <span class=o>=</span> <span class=n>SGD</span><span class=p>(</span><span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>,</span> <span class=n>momentum</span><span class=o>=</span><span class=mf>0.9</span><span class=p>,</span> <span class=n>decay</span><span class=o>=</span><span class=mf>1e-6</span><span class=p>,</span> <span class=n>nesterov</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>optimizer</span><span class=o>=</span><span class=n>sgd</span><span class=p>,</span> <span class=n>loss</span><span class=o>=</span><span class=s1>&#39;categorical_crossentropy&#39;</span><span class=p>,</span> <span class=n>metrics</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Train the model</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>train_X</span><span class=p>,</span> <span class=n>train_y</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>200</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=mi>5</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>model</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=s1>&#39;chatbot_model.h5&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>This neural network uses user input encoded as “bag of words” to classify the intent. It outputs probabilities, which are used to determine the best match for the user query.</p><hr><h2 id=step-5-creating-the-chat-functionality>Step 5: Creating the Chat Functionality</h2><p>Now, let’s combine everything into a function to handle live user input. When a user types something, the chatbot will process it and deliver an appropriate response:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>tensorflow.keras.models</span> <span class=kn>import</span> <span class=n>load_model</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>load_model</span><span class=p>(</span><span class=s1>&#39;chatbot_model.h5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>clean_up_sentence</span><span class=p>(</span><span class=n>sentence</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sentence_words</span> <span class=o>=</span> <span class=n>nltk</span><span class=o>.</span><span class=n>word_tokenize</span><span class=p>(</span><span class=n>sentence</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sentence_words</span> <span class=o>=</span> <span class=p>[</span><span class=n>lemmatizer</span><span class=o>.</span><span class=n>lemmatize</span><span class=p>(</span><span class=n>word</span><span class=o>.</span><span class=n>lower</span><span class=p>())</span> <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>sentence_words</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sentence_words</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>bow</span><span class=p>(</span><span class=n>sentence</span><span class=p>,</span> <span class=n>words</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>sentence_words</span> <span class=o>=</span> <span class=n>clean_up_sentence</span><span class=p>(</span><span class=n>sentence</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=mi>1</span> <span class=k>if</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>sentence_words</span> <span class=k>else</span> <span class=mi>0</span> <span class=k>for</span> <span class=n>word</span> <span class=ow>in</span> <span class=n>words</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_response</span><span class=p>(</span><span class=n>intents_list</span><span class=p>,</span> <span class=n>intents_json</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>tag</span> <span class=o>=</span> <span class=n>intents_list</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=s1>&#39;intent&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>intents</span> <span class=o>=</span> <span class=n>intents_json</span><span class=p>[</span><span class=s1>&#39;intents&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>intents</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>i</span><span class=p>[</span><span class=s1>&#39;tag&#39;</span><span class=p>]</span> <span class=o>==</span> <span class=n>tag</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>i</span><span class=p>[</span><span class=s1>&#39;responses&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>chatbot_response</span><span class=p>(</span><span class=n>text</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>input_bag</span> <span class=o>=</span> <span class=n>bow</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>words</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([</span><span class=n>input_bag</span><span class=p>]))[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=p>[{</span><span class=s2>&#34;intent&#34;</span><span class=p>:</span> <span class=n>classes</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=s2>&#34;probability&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=n>i</span><span class=p>])}</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>res</span><span class=p>))]</span>
</span></span><span class=line><span class=cl>    <span class=n>results</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>x</span><span class=p>[</span><span class=s2>&#34;probability&#34;</span><span class=p>],</span> <span class=n>reverse</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>float</span><span class=p>(</span><span class=n>results</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=s2>&#34;probability&#34;</span><span class=p>])</span> <span class=o>&gt;</span> <span class=mf>0.7</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>get_response</span><span class=p>(</span><span class=n>results</span><span class=p>,</span> <span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s2>&#34;I&#39;m sorry, I didn&#39;t understand that.&#34;</span>
</span></span></code></pre></div><hr><h2 id=step-6-adding-a-user-interface-with-flask>Step 6: Adding a User Interface with Flask</h2><p>To make our chatbot accessible, let’s create a simple web interface using Flask:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;Welcome to the Chatbot!&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/get&#34;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;GET&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_bot_response</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>user_text</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;msg&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>chatbot_response</span><span class=p>(</span><span class=n>user_text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><hr><h2 id=conclusion>Conclusion</h2><p>Congratulations! You’ve built a simple chatbot leveraging Natural Language Processing. While this chatbot handles basic queries, it serves as a foundation for building more advanced conversational agents. With further refinements—such as integrating external APIs, adding small talk, and improving model sophistication—you can take your chatbot to the next level.</p></div><footer class=post-footer><nav class=paginav>Category:<a href=https://science.googlexy.com/categories/machine-learning/>Machine Learning</a></nav><nav class=paginav><a class=prev href=https://science.googlexy.com/how-to-build-a-sentiment-analysis-model-using-machine-learning/><span class=title>« Prev</span><br><span>How to Build a Sentiment Analysis Model Using Machine Learning</span>
</a><a class=next href=https://science.googlexy.com/how-to-build-an-image-recognition-system-using-machine-learning/><span class=title>Next »</span><br><span>How to Build an Image Recognition System Using Machine Learning</span></a></nav><nav class=paginav><ul style=list-style-type:none><li><small>See Also</small></li><li><ul style=list-style-type:none><li><small><a href=/machine-learning-in-gaming-creating-realistic-and-immersive-experiences/>Machine Learning in Gaming: Creating Realistic and Immersive Experiences</a></small></li><li><small><a href=/machine-learning-in-robotics-advancing-automation-and-intelligent-machines/>Machine Learning in Robotics: Advancing Automation and Intelligent Machines</a></small></li><li><small><a href=/the-role-of-machine-learning-in-food-and-agriculture-supply-chains/>The Role of Machine Learning in Food and Agriculture Supply Chains</a></small></li><li><small><a href=/machine-learning-in-network-traffic-analysis/>Machine Learning in Network Traffic Analysis</a></small></li><li><small><a href=/the-advancements-in-natural-language-processing-for-chatbots-and-virtual-assistants/>The Advancements in Natural Language Processing for Chatbots and Virtual Assistants</a></small></li></ul></li></ul></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://science.googlexy.com/>All the science is here!</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>